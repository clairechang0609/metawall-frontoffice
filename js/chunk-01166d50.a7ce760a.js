(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01166d50"],{"25c5":function(e,t,n){"use strict";n("8fba")},7200:function(e,t,n){},"7bdd":function(e,t,n){"use strict";n.r(t);var a=n("7a23"),o=function(e){return Object(a["v"])("data-v-39cb5c76"),e=e(),Object(a["t"])(),e},c={class:"account-wrap"},r=o((function(){return Object(a["g"])("h3",{class:"title py-3 border bg-white text-center mb-4"},"修改個人資料",-1)})),i={class:"ms-2 nav nav-tabs border-0",id:"myTab",role:"tablist"},s={class:"nav-item"},d={class:"nav-item"},l={class:"tab-content rounded-card card"},u={key:0,id:"edit-name"},b={key:1,id:"edit-password"};function f(e,t,n,o,f,p){var m=Object(a["z"])("EditProfile"),h=Object(a["z"])("EditPassword");return Object(a["s"])(),Object(a["f"])("div",c,[r,Object(a["g"])("ul",i,[Object(a["g"])("li",s,[Object(a["g"])("button",{type:"button",class:Object(a["o"])(["nav-link border px-4",{active:"edit-name"===f.tab}]),onClick:t[0]||(t[0]=function(e){return f.tab="edit-name"})},"暱稱修改",2)]),Object(a["g"])("li",d,[Object(a["g"])("button",{type:"button",class:Object(a["o"])(["nav-link border px-4",{active:"edit-password"===f.tab}]),onClick:t[1]||(t[1]=function(e){return f.tab="edit-password"})},"重設密碼",2)])]),Object(a["g"])("div",l,["edit-name"===f.tab?(Object(a["s"])(),Object(a["f"])("div",u,[Object(a["i"])(m)])):Object(a["e"])("",!0),"edit-password"===f.tab?(Object(a["s"])(),Object(a["f"])("div",b,[Object(a["i"])(h)])):Object(a["e"])("",!0)])])}n("b0c0");var p=function(e){return Object(a["v"])("data-v-4a3e2ba0"),e=e(),Object(a["t"])(),e},m={class:"card-body p-4 d-flex flex-column align-items-center"},h=["src"],j={key:1,class:"photo rounded-circle border d-flex align-items-center justify-content-center mb-3"},O=p((function(){return Object(a["g"])("i",{class:"bi bi-person fs-1"},null,-1)})),g=[O],v={class:"mb-3"},w=p((function(){return Object(a["g"])("label",{for:"upload-file",class:"btn form-label bg-black text-white shadow-none py-1 mb-0"},"編輯大頭照",-1)})),k={class:"mt-3"},P={class:"mb-3"},y=p((function(){return Object(a["g"])("label",{for:"name",class:"form-label"},"暱稱",-1)})),x={class:"mb-3"},L=p((function(){return Object(a["g"])("label",{for:"gender",class:"form-label"},"性別",-1)})),_={class:"form-check form-check-inline"},E=p((function(){return Object(a["g"])("label",{class:"form-check-label",for:"female"},"女性",-1)})),U={class:"form-check form-check-inline"},C=p((function(){return Object(a["g"])("label",{class:"form-check-label",for:"male"},"男性",-1)})),M={key:0,class:"text-danger text-center d-block mt-3"},T=["disabled"],F={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},$=Object(a["h"])(" 送出更新 ");function z(e,t,n,o,c,r){return Object(a["s"])(),Object(a["f"])("div",m,[c.photoPreview?(Object(a["s"])(),Object(a["f"])("img",{key:0,src:c.photoPreview,class:"photo d-block mb-3 border rounded-circle"},null,8,h)):(Object(a["s"])(),Object(a["f"])("div",j,g)),Object(a["g"])("div",v,[w,Object(a["g"])("input",{class:"form-control d-none",type:"file",id:"upload-file",accept:"image/png, image/jpeg",ref:"upload-file",onChange:t[0]||(t[0]=function(e){return r.getPreviewFile()})},null,544)]),Object(a["g"])("form",k,[Object(a["g"])("div",P,[y,Object(a["K"])(Object(a["g"])("input",{type:"text",class:"form-control rounded-0",id:"name",placeholder:"請輸入暱稱","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.info.name=e})},null,512),[[a["G"],c.info.name]])]),Object(a["g"])("div",x,[L,Object(a["g"])("div",null,[Object(a["g"])("div",_,[Object(a["K"])(Object(a["g"])("input",{class:"form-check-input",type:"radio",id:"female",value:"female","onUpdate:modelValue":t[2]||(t[2]=function(e){return c.info.gender=e})},null,512),[[a["E"],c.info.gender]]),E]),Object(a["g"])("div",U,[Object(a["K"])(Object(a["g"])("input",{class:"form-check-input",type:"radio",id:"male",value:"male","onUpdate:modelValue":t[3]||(t[3]=function(e){return c.info.gender=e})},null,512),[[a["E"],c.info.gender]]),C])])]),c.errorMessage?(Object(a["s"])(),Object(a["f"])("div",M,Object(a["C"])(c.errorMessage),1)):Object(a["e"])("",!0),Object(a["g"])("button",{type:"button",class:"btn btn-secondary w-100 mt-3",onClick:t[4]||(t[4]=function(e){return r.submit()}),disabled:c.isLoading},[c.isLoading?(Object(a["s"])(),Object(a["f"])("span",F)):Object(a["e"])("",!0),$],8,T)])])}var I=n("1da1"),K=n("5530"),S=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("5502")),V={name:"EditProfile",data:function(){return{info:{name:"",photo:"",gender:""},photoPreview:"",isUpdatePhoto:!1,errorMessage:"",isLoading:!1}},computed:Object(K["a"])({},Object(S["c"])({token:function(e){return e.token}})),mounted:function(){this.getProfile()},methods:Object(K["a"])(Object(K["a"])({},Object(S["b"])(["setInfo"])),{},{getProfile:function(){var e=this,t={method:"GET",url:"".concat("https://peaceful-citadel-43202.herokuapp.com","/api/v1/user/profile"),headers:{authorization:"Bearer ".concat(this.token)}};this.$http(t).then((function(t){e.setProfile(t.data.data)}))["catch"]((function(e){console.log(e)}))},setProfile:function(e){var t=e.name,n=e.photo,a=e.gender;this.info={name:t,photo:n,gender:a},this.photoPreview=n},getPreviewFile:function(){var e=this.$refs["upload-file"];this.photoPreview=URL.createObjectURL(e.files[0]),this.isUpdatePhoto=!0},uploadFile:function(){var e=this;return new Promise((function(t,n){var a=e.$refs["upload-file"],o=new FormData;o.append("image",a.files[0]),a.files=(new DataTransfer).files;var c={method:"POST",url:"".concat("https://peaceful-citadel-43202.herokuapp.com","/api/v1/file"),headers:{authorization:"Bearer ".concat(e.token)},data:o};e.$http(c).then((function(e){t(e.data.data)}))["catch"]((function(e){n(e.response.data.message)}))}))},updateProfile:function(){var e=this;return new Promise((function(t,n){var a={method:"PATCH",url:"".concat("https://peaceful-citadel-43202.herokuapp.com","/api/v1/user/profile"),headers:{authorization:"Bearer ".concat(e.token)},data:e.info};e.$http(a).then((function(e){t(e.data.data)}))["catch"]((function(e){n(e.response.data.message)}))}))},submit:function(){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.isLoading=!0,!e.isUpdatePhoto){t.next=7;break}return t.next=5,e.uploadFile();case 5:n=t.sent,e.info.photo=n;case 7:return t.next=9,e.updateProfile();case 9:a=t.sent,e.setProfile(a),e.setInfo({_id:a._id,name:a.name,photo:a.photo}),e.errorMessage="",e.isLoading=!1,t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](0),e.errorMessage=t.t0,e.isLoading=!1;case 20:case"end":return t.stop()}}),t,null,[[0,16]])})))()}})},B=(n("25c5"),n("6b0d")),G=n.n(B);const R=G()(V,[["render",z],["__scopeId","data-v-4a3e2ba0"]]);var A=R,D=function(e){return Object(a["v"])("data-v-0d15e3ba"),e=e(),Object(a["t"])(),e},H={class:"card-body p-4 d-flex flex-column align-items-center"},J={class:"mb-3"},X=D((function(){return Object(a["g"])("label",{for:"password",class:"form-label"},"輸入新密碼",-1)})),q={class:"mb-3"},N=D((function(){return Object(a["g"])("label",{for:"confirm_password",class:"form-label"},"再次輸入",-1)})),Q={key:0,class:"text-danger text-center d-block mt-3"},W=["disabled"],Y={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Z=Object(a["h"])(" 重設密碼 ");function ee(e,t,n,o,c,r){return Object(a["s"])(),Object(a["f"])("div",H,[Object(a["g"])("form",null,[Object(a["g"])("div",J,[X,Object(a["K"])(Object(a["g"])("input",{type:"password",class:"form-control rounded-0",id:"password",placeholder:"請輸入新密碼","onUpdate:modelValue":t[0]||(t[0]=function(e){return c.info.password=e})},null,512),[[a["G"],c.info.password]])]),Object(a["g"])("div",q,[N,Object(a["K"])(Object(a["g"])("input",{type:"password",class:"form-control rounded-0",id:"confirm_password",placeholder:"再次輸入輸入新密碼","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.info.confirmPassword=e})},null,512),[[a["G"],c.info.confirmPassword]])]),c.errorMessage?(Object(a["s"])(),Object(a["f"])("div",Q,Object(a["C"])(c.errorMessage),1)):Object(a["e"])("",!0),Object(a["g"])("button",{type:"button",class:"btn btn-secondary w-100 mt-3",disabled:!r.isFinished||c.isLoading,onClick:t[2]||(t[2]=function(e){return r.submit()})},[c.isLoading?(Object(a["s"])(),Object(a["f"])("span",Y)):Object(a["e"])("",!0),Z],8,W)])])}var te={name:"EditPassword",data:function(){return{info:{password:"",confirmPassword:""},errorMessage:"",isLoading:!1}},computed:Object(K["a"])(Object(K["a"])({},Object(S["c"])({token:function(e){return e.token}})),{},{isFinished:function(){return this.info.password&&this.info.confirmPassword}}),mounted:function(){},methods:Object(K["a"])(Object(K["a"])({},Object(S["b"])(["setToken"])),{},{submit:function(){var e=this;this.isLoading=!0;var t={method:"PATCH",url:"".concat("https://peaceful-citadel-43202.herokuapp.com","/api/v1/user/update_password"),headers:{authorization:"Bearer ".concat(this.token)},data:this.info};this.$http(t).then((function(t){e.setToken(t.data.data.token),Object.assign(e.$data,e.$options.data())}))["catch"]((function(t){e.errorMessage=t.response.data.message,e.isLoading=!1}))}})};n("c9de");const ne=G()(te,[["render",ee],["__scopeId","data-v-0d15e3ba"]]);var ae=ne,oe={name:"Account",components:{EditProfile:A,EditPassword:ae},data:function(){return{tab:"edit-name"}},methods:{}};n("f7f2");const ce=G()(oe,[["render",f],["__scopeId","data-v-39cb5c76"]]);t["default"]=ce},"8fba":function(e,t,n){},b0c0:function(e,t,n){var a=n("83ab"),o=n("5e77").EXISTS,c=n("e330"),r=n("9bf2").f,i=Function.prototype,s=c(i.toString),d=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,l=c(d.exec),u="name";a&&!o&&r(i,u,{configurable:!0,get:function(){try{return l(d,s(this))[1]}catch(e){return""}}})},c9de:function(e,t,n){"use strict";n("ce27")},ce27:function(e,t,n){},f7f2:function(e,t,n){"use strict";n("7200")}}]);
//# sourceMappingURL=chunk-01166d50.a7ce760a.js.map